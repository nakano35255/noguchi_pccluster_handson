# 野口研究室PCクラスターの使用法

## ログイン

野口研究室は３つの計算機サーバーを持っている。
それぞれ以下のIPアドレスとが割り当てられている。

- **nok00.issp.u-tokyo.ac.jp**
  - IPアドレス: 192.168.93.166
- **nog00.issp.u-tokyo.ac.jp**
  - IPアドレス: 192.168.93.196
- **nox00.issp.u-tokyo.ac.jp**
  - IPアドレス: 192.168.93.202

nox00は古い計算機なので基本的に用いず、nok00とnog00を用いること。

terminalから以下のコマンドでそれぞれのサーバーにログインできる。

```sh
ssh username@192.168.93.166
```
usernameは登録したusernameであり、IPアドレス部分はログインしたいサーバーごとに変更する。

上記のコマンドを打つと、以下のようにパスワードが求められるので登録済みのパスワードを入力する。

```sh
ssh username@192.168.93.166
username@192.168.93.166's password: 
Last login: Wed Jul 10 12:43:40 2024 from 192.168.00.000
```
するとログインできる。


## コンパイルとジョブの投入

ここではPCクラスタ上でどのように計算を実行するかを説明する。
特にc++で書かれたプログラムの投げ方を説明する。

最初にテスト用のコードを書こう。
```sh
mkdir handson
cd handson
```
として、handsonフォルダに移動する。そして、
```sh
vim test.cpp
```
でtest.cppを開き、以下を書き込む。
```sh

```

このプログラムの実行するにはコンパイルする必要がある。野口研PCクラスタでは、Cプログラムの場合をC++プログラムの場合を用いる。
```sh
mpicxx -O3 -o out.exe test.cpp
```

PCクラスタやスパコンのような共有計算資源では、プログラムをジョブスクリプトを用いて計算機に投げ、順番待ちをする。この順番待ちの列を「キュー（Queue）」と呼ぶ。プログラムをバッチジョブとして実行するためには、ジョブスケジューラに対してどのような計算資源を要求するか、どのようにプログラムを実行するかを指定する必要がある。バッチジョブは、あらかじめ定義された一連の処理を一括して実行するジョブのことである。ジョブスクリプトは、特殊なコメント欄を持つシェルスクリプトで、これを用いてジョブスケジューラに指示を与える。

実際にジョブスクリプトを書いてみる。
```sh
vim test.sh
```
を入力しtest.shを開き、以下を書き込む。
```sh
#!/bin/bash

#SBATCH -p defq
#SBATCH -N 1
#SBATCH -n 4
#SBATCH -c 1

srun --exclusive --mem-per-cpu=1840 -n 4 -N 1 ./a.out &

wait
```